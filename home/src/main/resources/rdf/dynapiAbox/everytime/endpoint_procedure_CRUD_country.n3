@prefix rdf:  			<http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:  			<http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:   			<http://www.w3.org/2002/07/owl#> .
@prefix vitro: 			<http://vitro.mannlib.cornell.edu/ns/vitro/0.7#> .
@prefix dynapi: 		<https://vivoweb.org/ontology/vitro-dynamic-api#> .
@prefix dynapi_java: 	<java:edu.cornell.mannlib.vitro.webapp.dynapi.components#> .
@prefix xsd: 			<http://www.w3.org/2001/XMLSchema#> .

###############################################
### CREATE
###############################################

<https://vivoweb.org/procedure/create_country>
        a                        			dynapi:Procedure ;
        rdfs:label               			"Create a country"@en-US ;
        dynapi:hasFirstStep 				<https://vivoweb.org/procedure/create_country/execute_template/step> ;
        dynapi:providesParameter            <https://vivoweb.org/procedure/country/parameter/country_uri>  .

<https://vivoweb.org/procedure/create_country/execute_template/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"Creation of a country by using N3 operation"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/create_country/execute_template/n3_template> .

<https://vivoweb.org/procedure/create_country/execute_template/n3_template>
        a                        			dynapi:N3Template ;
        rdfs:label               			"Create country N3 Template"@en-US ;
        dynapi:hasModel 					<https://vivoweb.org/ontology/vitro-dynamic-api/model/countries> ;
        dynapi:requiresParameter 			<https://vivoweb.org/procedure/country/parameter/country_uri>;
        dynapi:requiresParameter            <https://vivoweb.org/procedure/country/parameter/country_label> ;
        dynapi:N3TextAdditions
        """
        ?country_uri
            <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing> ;
            <http://www.w3.org/2000/01/rdf-schema#label> ?country_label .
        """ .

###############################################
### READ (all)
###############################################

<https://vivoweb.org/procedure/read_countries>
        a                                   dynapi:Procedure ;
        rdfs:label                          "Fetching countries"@en-US ;
        dynapi:providesParameter 			<https://vivoweb.org/ontology/country/parameter/countries> ;
        dynapi:providesParameter 			<https://vivoweb.org/ontology/country/parameter/count>;
        dynapi:hasFirstStep 				<https://vivoweb.org/procedure/read_countries/fetching_properties/step> .

<https://vivoweb.org/procedure/read_countries/fetching_properties/step>
        a                                   dynapi:OperationalStep ;
        rdfs:label                          "fetch countries step"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/read_countries/fetching_properties/sparql_select_query> ;
		dynapi:hasNextStep					<https://vivoweb.org/ontology/read_countries/statistics/step> .

<https://vivoweb.org/procedure/read_countries/fetching_properties/sparql_select_query>
        a                                       dynapi:SparqlSelectQuery ;
        rdfs:label                              "read countries sparql query"@en-US ;
        dynapi:hasModel 					    <https://vivoweb.org/ontology/vitro-dynamic-api/model/full_union> ;
        dynapi:providesParameter 			    <https://vivoweb.org/ontology/country/parameter/countries> ;
		dynapi:requiresParameter 			    <https://vivoweb.org/ontology/country/parameter/limit> ;
		dynapi:requiresParameter                <https://vivoweb.org/ontology/country/parameter/offset> ;
		dynapi:requiresPlainParameter           <https://vivoweb.org/ontology/country/parameter/sortBy> ;
		dynapi:requiresPlainParameter           <https://vivoweb.org/ontology/country/parameter/order> ;
        dynapi:sparqlQueryText
        """
        SELECT ?uri ?label
            WHERE
                {
                      ?uri <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing>
                      OPTIONAL { ?uri <http://www.w3.org/2000/01/rdf-schema#label> ?label }
                }
            ORDER BY ?order(??sortBy)
            LIMIT ?limit OFFSET ?offset
        """ .

<https://vivoweb.org/ontology/read_countries/statistics/step>
        a                                   dynapi:OperationalStep ;
        rdfs:label                          "number of countries step "@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/ontology/read_countries/statistics/sparql_query> .

<https://vivoweb.org/ontology/read_countries/statistics/sparql_query>
        a                                   dynapi:SparqlSelectQuery ;
        rdfs:label                          "number of countries sparql query 1"@en-US ;
        dynapi:hasModel 					<https://vivoweb.org/ontology/vitro-dynamic-api/model/full_union> ;
        dynapi:providesParameter 			<https://vivoweb.org/ontology/country/parameter/count> ;
        dynapi:sparqlQueryText
        """
        SELECT (count(distinct ?uri) as ?total)
            WHERE
                {
                    ?uri <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing>
                }
        """ .

###############################################
### READ (one)
###############################################

<https://vivoweb.org/ontology/read_country>
        a                                   dynapi:Procedure ;
        rdfs:label                          "Fetching a country"@en-US ;
        dynapi:providesParameter 			<https://vivoweb.org/ontology/country/parameter/countries> ;
        dynapi:hasFirstStep 				<https://vivoweb.org/procedure/read_country/fetching_properties/step> .

<https://vivoweb.org/procedure/read_country/fetching_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"reading of a country"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/read_country/fetching_properties/sparql_query> .

<https://vivoweb.org/procedure/read_country/fetching_properties/sparql_query>
        a                                   dynapi:SparqlSelectQuery ;
        rdfs:label                          "read countries sparql query 1"@en-US ;
        dynapi:hasModel 					<https://vivoweb.org/ontology/vitro-dynamic-api/model/full_union> ;
        dynapi:requiresParameter 			<https://vivoweb.org/ontology/country/parameter/resourceId> ;
        dynapi:providesParameter 			<https://vivoweb.org/ontology/country/parameter/countries> ;
        dynapi:sparqlQueryText
        """
        SELECT ?uri ?label
            WHERE
                {
                    ?uri <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing>
                    OPTIONAL { ?uri <http://www.w3.org/2000/01/rdf-schema#label> ?label }
                    FILTER (?uri = ?resource_id)
                }
        """ .

###############################################
### UPDATE
###############################################

<https://vivoweb.org/ontology/update_country>
        a                                   dynapi:Procedure ;
        rdfs:label                          "Updating a country"@en-US ;
        dynapi:hasFirstStep 				<https://vivoweb.org/procedure/update_country/fetching_properties/step> .

<https://vivoweb.org/procedure/update_country/fetching_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"Fetching of a country data for deleting"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/delete_country/fetching_properties/sparql_query> ;
        dynapi:hasNextStep  				<https://vivoweb.org/procedure/update_country/deleting_properties/step> .

<https://vivoweb.org/procedure/update_country/deleting_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"Deleting of a country"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/delete_country/deleting_properties/n3_template> ;
        dynapi:hasNextStep  				<https://vivoweb.org/procedure/update_country/addding_properties/step> .

<https://vivoweb.org/procedure/update_country/addding_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"creation of a country "@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/create_country/execute_template/n3_template> .


###############################################
### DELETE
###############################################

<https://vivoweb.org/procedure/delete_country>
        a                        			dynapi:Procedure ;
        rdfs:label               			"Removing of a country"@en-US ;
        dynapi:hasFirstStep 				<https://vivoweb.org/procedure/delete_country/fetching_properties/step> .

<https://vivoweb.org/procedure/delete_country/fetching_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"Fetching of a country data for deleting"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/delete_country/fetching_properties/sparql_query> ;
        dynapi:hasNextStep  				<https://vivoweb.org/procedure/delete_country/deleting_properties/step> .

<https://vivoweb.org/procedure/delete_country/fetching_properties/sparql_query>
        a                                   dynapi:SparqlSelectQuery ;
        rdfs:label                          "Read countries sparql query"@en-US ;
        dynapi:hasModel 					<https://vivoweb.org/ontology/vitro-dynamic-api/model/full_union> ;
        dynapi:requiresParameter 			<https://vivoweb.org/ontology/country/parameter/resourceId> ;
        dynapi:providesParameter 			<https://vivoweb.org/procedure/country/parameter/country_for_deleting> ;
        dynapi:sparqlQueryText
        """
        SELECT ?uri ?label
            WHERE
            {
                  ?uri <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing>
                  OPTIONAL { ?uri <http://www.w3.org/2000/01/rdf-schema#label> ?label }
                  FILTER (?uri = ?resource_id)
            }
        """ .

<https://vivoweb.org/procedure/delete_country/deleting_properties/step>
        a                        			dynapi:OperationalStep ;
        rdfs:label               			"Deleting of a country"@en-US ;
        dynapi:hasOperation 				<https://vivoweb.org/procedure/delete_country/deleting_properties/n3_template> .

<https://vivoweb.org/procedure/delete_country/deleting_properties/n3_template>
        a                        			dynapi:N3Template ;
        rdfs:label               			"delete country label N3 Template"@en-US ;
        dynapi:hasModel 					<https://vivoweb.org/ontology/vitro-dynamic-api/model/abox_assertions> ;
        dynapi:requiresParameter 			<https://vivoweb.org/procedure/country/parameter/country_for_deleting> ;
        dynapi:N3TextRetractions
        """
        ?country_for_deleting.0.uri
            <http://www.w3.org/2000/01/rdf-schema#label> ?country_for_deleting.0.label ;
            <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://aims.fao.org/aos/geopolitical.owl#self_governing> .
        """ .

###############################################
### PARAMETERS
###############################################

<https://vivoweb.org/ontology/country/parameter/countries>
        a                                   dynapi:Parameter ;
        rdfs:label                          "countries"@en-US ;
        dynapi:name                         "result" ;
        dynapi:description                  "List of available countries and statistics (number)" ;
        dynapi:hasType                      <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/JsonContainerArray> .

# <https://vivoweb.org/ontology/country/parameter/type/resultUriLabelArrayType>
#        a                                   dynapi:parameterType ,
#                                            dynapi:arrayParameterType ,
#                                            dynapi_java:types.ParameterType ,
#                                            dynapi_java:types.ArrayParameterType ;
#        rdfs:label                          "Result (uri, label) array type"@en-US ;
#        dynapi:name                         "array of results" ;
#        dynapi:hasElementsOfType 			<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/uriLabelObjectType> .
#
# <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/uriLabelObjectType>
#        a                                   dynapi:parameterType ,
#											dynapi:objectParameterType ,
#											dynapi_java:types.ParameterType ,
#											dynapi_java:types.ObjectParameterType ;
#        rdfs:label                          "Data (uri, label) object type"@en-US ;
#        dynapi:name                         "object uri label" ;
#        dynapi:hasInternalElement 			<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/uri> ,
#											<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/label> .

<https://vivoweb.org/ontology/country/parameter/count>
        a                                   dynapi:Parameter ;
        rdfs:label                          "Number of fetched countries"@en-US ;
        dynapi:name                         "count" ;
        dynapi:hasType                      <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/JsonContainer> .

#<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/resultCountArrayType>
#        a                                   dynapi:parameterType ,
#                                            dynapi:arrayParameterType ,
#                                            dynapi_java:types.ParameterType ,
#                                            dynapi_java:types.ArrayParameterType ;
#        rdfs:label                          "Result (uri, label) array type"@en-US ;
#        dynapi:name                         "array of total numbers" ;
#        dynapi:hasElementsOfType 			<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/totalCountObjectType> .

# <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/totalCountObjectType>
#        a                                   dynapi:parameterType ,
#											dynapi:objectParameterType ,
#											dynapi_java:types.ParameterType ,
#											dynapi_java:types.ObjectParameterType ;
#        rdfs:label                          "Counts (total) object type"@en-US ;
#        dynapi:name                         "object" ;
#        dynapi:hasInternalElement 			<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/total> .

<https://vivoweb.org/ontology/country/parameter/countryForDeleting>
        a                                   dynapi:Parameter ;
        rdfs:label                          "country for deleting"@en-US ;
        dynapi:name                         "stateOrProvinceForDeleting" ;
        dynapi:description                  "List of available countries" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/JsonContainerArray> .

<https://vivoweb.org/procedure/country/parameter/country_uri>
        a                                   dynapi:Parameter ;
        dynapi:name                         "country_uri" ;
        dynapi:defaultValue                 "http://aims.fao.org/aos/geopolitical.owl#,java_uuid_number" ;
        dynapi:isInternal                   "true"^^xsd:boolean ;
        dynapi:hasType                      <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/generated-uri> .

<https://vivoweb.org/procedure/country/parameter/country_label>
        a                                   dynapi:Parameter ;
        dynapi:name                         "country_label" ;
        dynapi:defaultValue                 "http://aims.fao.org/aos/geopolitical.owl#,country_label" ;
        dynapi:hasType                      <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/string-literal> .

#<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/uri>
#        a                       			dynapi:parameter ;
#        dynapi:name             			"uri" ;
#        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/XSDanyURI> ;
#        rdfs:label              			"uri"@en-US .


#<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/label>
#        a                        			dynapi:parameter ;
#        dynapi:name              			"label" ;
#        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/XSDstring> ;
#        rdfs:label               			"label"@en-US .

<https://vivoweb.org/ontology/country/parameter/resourceId>
        a                        			dynapi:parameter ;
        dynapi:name              			"resource_id" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/uri> ;
        rdfs:label               			"resource uri"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/total>
        a                        			dynapi:parameter ;
        dynapi:name              			"total" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/integer> ;
        rdfs:label               			"total"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/limit>
        a                        			dynapi:parameter ;
        dynapi:name              			"limit" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/integer> ;
        rdfs:label               			"limit"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/offset>
        a                        			dynapi:parameter ;
        dynapi:name              			"offset" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/integer> ;
        rdfs:label               			"offset"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/sortBy>
        a                        			dynapi:parameter ;
        dynapi:name              			"sortBy" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/string> ;
        rdfs:label               			"sortBy"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/order>
        a                        			dynapi:parameter ;
        dynapi:name              			"order" ;
        dynapi:hasType 						<https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/string> ;
        rdfs:label               			"order"@en-US .

<https://vivoweb.org/ontology/vitro-dynamic-api/model/countries>
        a                       dynapi:Model ;
        dynapi:name             "http://vitro.mannlib.cornell.edu/filegraph/abox/geopolitical.abox.ver1.1-11-18-11.owl" ;
        rdfs:label              "countries model"@en-US ;
        dynapi:hasType          <https://vivoweb.org/ontology/vitro-dynamic-api/parameter/type/model> .



<https://vivoweb.org/ontology/vitro-dynamic-api/resourceAPI/country>
        a                                   dynapi:resourceAPI ;
        rdfs:label                          "country resourceAPI 1"@en-US ;
        dynapi:name                         "country" ;
        dynapi:minAPIVersion                "1.0.0" ;
        dynapi:onPost 						<https://vivoweb.org/ontology/vitro-dynamic-api/rpc/createCountryRPC> ;
        dynapi:onDelete 					<https://vivoweb.org/ontology/vitro-dynamic-api/rpc/deleteCountryRPC> ;
        dynapi:onGet 						<https://vivoweb.org/ontology/vitro-dynamic-api/rpc/readCountryRPC> ;
        dynapi:onPut 						<https://vivoweb.org/ontology/vitro-dynamic-api/rpc/updateCountryRPC> ;
        dynapi:onGetAll 					<https://vivoweb.org/ontology/vitro-dynamic-api/rpc/readCountriesRPC> .